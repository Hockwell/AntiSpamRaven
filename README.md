# AntiSpamRaven
> python 3.8. ML libs. Visual Studio.

Используются различные ML-алгоритмы для обнаружения текстового спама.
## Архитектура
Препроцессинг, feature extraction, обучение, детект и исследования разделены между собой, что позволяет, изменяя один модуль, быстро в результате изменять работу процесса детекта. Вплоть до того, что можно включить один из подходов (выключив другой) feature extraction или препроцессинга, например. 
## Препроцессинг
Стемминг Портера (NTLK), удалены слишком длинные семплы, а также стоп-слова
## Feature engineering
Базовый принцип: Bag of words
Варианты: 1)words counts, 2)tf, 3)tf-idf. 
## Research functional (Res)
Исследовательские функции
### Алгоритмы поиска лучших комбинаций алгоритмов
Выбираем методы препроцессинга, feature extraction, задаём список алгоритмов. Далее можно использовать следующие алгоритмы.
1. Поиск дизъюнктивных комбинаций (достаточно вердикта "спам" от одного алгоритма для детекта)
2. Поиск коньюнктивных комбинаций 
#### Результаты
Сортировка результатов по метрикам. Результаты экспортируются в .log
#### Метрики качества
f1, auc, recall, precision, accuracy, time of prediction, time of learning.
#### Как используются результаты
Далее найденную комбинацию можно использовать для создания многих моделей, 
каждая из которых может отличаться от других лишь словарями - каждая может быть заточена под обнаружение опред. типа спама, 
но в основе будут лежать одинаковая комбинация алгоритмов. 
### Исследовательские модели
- Созданы различные модели, какие-то обнаруживают конкретного типа спам, какие-то несколько типов. 
- Каждая модель обучается на своём датасете, проводит свой препроцессинг и feature extraction - имеет свой уникальный "bag of words".
- Тестируется на тестовом датасете, кросс-валидация не проводится.
Сценарий: 
1. Обучаем модель.
2. Заставляем её предсказывать спам семплов, над которыми уже проведена предобработка и извлечение признаков (это сплитированная часть семплов из первоначального датасета, остальная часть которого стала обучающей, однако можно взять семплы и из других датасетов, если признаки совпадают, функция predict принимает датасет для предсказания). 
## Detection functional (Det)
Статус: не реализован

Классификация случайных семплов (анти-спам система).
### Детектирующие модели
- Входящий семпл поступает во все модели и помечается тем типом спама, которому соответствует обнаружившая модель.
## Управление
#### Как изменить состав алгоритмов для алгоритма поиска комбинаций
Необходимо изменить словарь algs в main.py. Всё остальное будет выполнено автоматически.
#### Изменить параметры поиска комбинаций алгоритмов
В классе AlgsBestCombinationSearcher. Непосредственно параметры - при вызове algs_searcher.run(...).

