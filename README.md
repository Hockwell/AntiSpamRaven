# AntiSpamRaven
> Visual Studio 2019. Anaconda 2020.02. 

Используются различные ML-алгоритмы для обнаружения текстового спама.
## Архитектура
1) Препроцессинг с датасетами, feature extraction, обучение/прогноз разделены между собой - можно включить один из подходов (выключив другой) на любом из этих этапах.
2) Код написан с использованием ООП с высокой степенью обобщения, реализована кодовая база, позволяющая легко модернизировать код, не ломая остальной, а также быстро реализовать валидацию недостающих типов - стекинга и бустинга. 
## Препроцессинг
Стемминг Портера (NTLK), удалены слишком длинные семплы, стоп-слова, специфические конструкции сгруппированы в определённые слова. 
## Feature engineering
Базовый принцип: Bag of words

Варианты: 1)words counts, 2)tf, 3)tf-idf. Можно настроить длинну извлекаемых n-грамм. 
## Research functional (Res)
Исследовательские функции
### Автоматизация валидации
Реализован механизм задания и исполнения тестовых сценариев, где можно указать задействованный функционал и параметры. Программа автоматически по каждому сценарию работает и помещает в определённые каталоги фаловой системы результаты. 
### Скорость валидации
Когда генерируется большое кол-во комбинаций, каждая из которых может включать в себя несколько алгоритмов ML, особенно важно быстро провести валидацию. Для тривиальных комбинаций результаты работы алгоритмов-одиночек сохраняются, потом многократно связываются в рамках комбинаций и процессы обучения и прогнозирования не повторяются. Сами алгоритмы ML используются с n_jobs=-1 там, где это возможно, чтобы обеспечить максимальную многопоточность.
### Валидатор алгоритмов
Алгоритм позволяет валидировать/сравнивать поданные на вход алгоритмы-одиночки как в стандарном режиме (кросс-валидация поданных алгоритмов), так и в режиме генерации комбинаций разных типов из них.
Выбираем методы препроцессинга, feature extraction, задаём список алгоритмов. Далее можно использовать следующие алгоритмы.
1. Поиск дизъюнктивных комбинаций (достаточно вердикта "спам" от одного алгоритма для детекта).
2. Поиск коньюнктивных комбинаций. 
3. Поиск мажоритарных комбинаций (связывание алгоритмов голосованием).
4. Поиск бэггинговых комбинаций (добавление бутстрап-выборок).
1-3 комбинации называются тривиальными.
#### Результаты
1. Сортировка результатов по метрикам. Результаты экспортируются в .log, автоматически помещаются по каталогам в зависимости от параметров тестирования для удобства их анализа.
2. Удобная фильтрация результатов. Доступно несколько разных методов, каждый из которых может быть выключен. 
#### Метрики качества
f1, auc, recall, precision, accuracy, time of prediction, time of learning.
#### Как используются результаты
Далее найденную комбинацию можно использовать для создания многих моделей, 
каждая из которых может отличаться от других лишь словарями - каждая может быть заточена под обнаружение опред. типа спама, 
но в основе будут лежать одинаковая комбинация алгоритмов. 
## Detection functional (Det)
> Статус: не реализован

Функции обнаружения случайных семплов (анти-спам система).
### Детектирующие модели
- Входящий семпл поступает во все модели и помечается тем типом спама, которому соответствует обнаружившая модель.
## Управление
#### Как изменить состав алгоритмов для алгоритма поиска комбинаций
Необходимо изменить словарь algs в main.py. Всё остальное будет выполнено автоматически.
#### Изменить параметры поиска комбинаций алгоритмов
В классе AlgsBestCombinationSearcher. Непосредственно параметры - при вызове algs_searcher.run(...).
#### Стабильность
Весь реализованный код полностью рабочий, если не сказано в комментариях иное. Возможные падения нагрузки на CPU временные.
## Частично реализованный функционал
#### Многопоточная (multiprocessing) валидация тривиальных комбинаций
Было реализовано 2 подхода: 1) producer-consumers, 2) на каждый подпроцесс подаётся свой уникальный набор задач для обработки, т.е. задачи в данном случае - не общий ресурс. Оба не работают. 
Предположительно степень готовности высокая и сама концепция обработки комбинаций процессами реализована верно, но не все технические проблемы были разрешены.